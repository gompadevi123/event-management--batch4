<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>View Registrations</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/viewh.css') }}">
</head>
<body>
    <h1>Hall Bookings</h1>
    
{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        <div class="alert-container">
            {% for category, message in messages %}
                <div class="alert alert-{{ category }}">
                    {{ message }}
                </div>
            {% endfor %}
        </div>
    {% endif %}
{% endwith %}

<table border="1">
    <thead>
        <tr>
            <th>Booking ID</th>
            <th>Name</th>
            <th>Location</th>
            <th>Start Time</th>
            <th>End Time</th>
            <th>Description</th>
            <th>Hall Capacity</th>
            <th>User Email</th>
            <th>User ID</th> <!-- Display User ID -->
            <th>Ticket Class</th>
            <th>Bank Name</th>
            <th>Card Type</th>
            <th>Payment Date</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for booking in hall_bookings %}
        <tr>
            <td>{{ booking.booking_id }}</td>
            <td>{{ booking.name }}</td>
            <td>{{ booking.location }}</td>
            <td>{{ booking.start_time }}</td>
            <td>{{ booking.end_time }}</td>
            <td>{{ booking.description }}</td>
            <td>{{ booking.hall_capacity }}</td>
            <td>{{ booking.user_email }}</td>
            <td>{{ booking.user_id }}</td> <!-- Display the fetched user_id -->
            <td>{{ booking.ticket_class if booking.ticket_class else 'Not Provided' }}</td>
            <td>{{ booking.bank_name if booking.bank_name else 'Not Provided' }}</td>
            <td>{{ booking.card_type if booking.card_type else 'Not Provided' }}</td>
            <td>{{ booking.created_at if booking.created_at else 'Not Provided' }}</td>
            <td>
                <form method="POST" action="{{ url_for('send_appointment_email', booking_id=booking.booking_id) }}">
                    <input type="date" name="appointment_date" required>
                    <button type="submit" class="btn btn-primary">Send Email</button>
                </form>
                <form method="POST" action="{{ url_for('send_notification', booking_id=booking.booking_id) }}">
                    <textarea name="notification_text" required placeholder="Enter notification message"></textarea><br>
                    <button type="submit" class="btn btn-secondary">Send Notification</button>
                </form>
            </td>
        </tr>
        {% else %}
        <tr>
            <td colspan="13">No bookings found</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
